# 数据链路层

### 1. 概述

![](image/数据链路.png)

点对点信道数据链路层的三个重要问题：==封装成帧，差错检测，可靠传输。==

1. 数据链路层会把上层得到的数据段加上帧头和帧尾，封装成帧进行传输。

2. 差错检测会根据帧尾中包含的检测码检查是否出现误码。

3. 误码是不可避免的，但若对方发送什么，接收方就能收到什么，称为可靠传输。



### 2. 封装成帧

![](image/封装成帧.png)

1. 封装成帧是指数据链路层把上层交付的协议数据单元添加帧头和帧尾使之成帧。

2. 帧头和帧尾包括重要的控制信息，可以作为帧定界（有一些定界是靠物理层增加码头进行分辨）。

3. 透明传输是指数据链路层对于上层交付的传输数据没有任何限制。



### 3. 差错检测

1. 误码率：传输过程中出现误码数和总的码数的比值。

2. 奇偶校验：分为奇校验和偶校验，但是只能检测出偶数位/奇数位出现误码的情况，因此检漏率比较高。

3. 循环冗余校验CRC检漏率比较低，广泛应用于数据链路层。

![](image/CRC.png) 



### 4. 可靠传输

##### 4.1 可靠传输的基本概念

![](image/可靠传输基本概念.png)

![](image/http可靠传输.png)

##### 4.2 可靠传输的实现机制

1. 停止-等待协议（SW）

    ![](image/SW.png)

    ![](image/信道利用率1.png)

2. 回退N帧协议GBN

    ![](image/GBN.png)

3. 选择重传协议SR
   
    ![](image/SR.png)

    ![](image/SR2.png)



### 5. PPP协议

![](image/PPP.png)

![](image/PPP1.png)

![](image/PPP2.png)



### 6. 媒体接入控制MAC

##### 6.1 MAC 基本概念

![](image/MAC基本概念.png)

##### 6.1.1 静态划分信道

**信道复用**：复用是通信技术中的一个重要概念，复用就是通过一条物理线路同时传输多路用户的信号，当网络中传输媒体的传输容量大于多条单一信道传输的总通信量时，可以利用复用技术在一条物理线路上建立多条通信信道来充分利用传输媒体的带宽。

分为==频分复用（多址），时分复用（多址），波分复用（多址），码分复用（多址）==

![](image/静态划分信道.png)

##### 6.1.2 动态接入控制

**随机接入-CSMA/CD（载波监听多址接入/碰撞检测）**

![](image/CSMACD.png)

**随机接入-CSMA/CA（载波监听多址接入/碰撞避免）**

![](image/CSMACA.png)

==帧间间隔IFS==

![](image/IFS.png)

==CSMA/CA协议工作原理==

![](image/CA工作原理.png)

==CSMA/CA退避算法==

![](image/CA退避算法.png)

==信道预约==

![](image/信道预约.png)

![](image/信道预约2.png)

==虚拟载波监听==

![](image/虚拟载波监听.png)



### 7. MAC地址，IP地址和ARP协议

(MAC地址位于数据链路层，IP地址和ARP协议是网际层的内容)

![](image/MAC+IP+ARP.png)

##### MAC地址

![](image/MAC地址.png)

==单波MAC地址，广播MAC地址，多播MAC地址，随机MAC地址==

![](image/MAC播地址.png)

##### IP地址

![](image/IP地址.png)

##### 地址解析协议ARP

![](image/ARP.png)



### 8. 集线器（HUB）和交换机（switch）

![](image/集线器和交换机.png)

==集线器==

![](image/集线器.png)

==交换机==

![](image/交换机.png)

==交换机工作流程==

![](image/交换机工作流程.png)



### 10. 以太网交换机的生成树协议STP

![](image/STP.png)

### 11. 虚拟局域网VLAN

##### 11.1 VLAN概述

![](image/VLAN概述.png)

##### 11.2 VLAN实现机制

**交换机需要处理带有VLAN标记的帧（IEEE 801.Q帧，交换机各端口可以处理不同的端口类型**

==IEEE 802.1Q帧==

![](image/IEEE%20802.1Q帧.png)

==Acess端口==

![](image/Acess端口.png)

==Trunk端口== 

![](image/Trunk端口.png)

==Hybrid端口== (华为交换机私有)

![](image/Hybrid端口.png)



